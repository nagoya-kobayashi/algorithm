# 探索ゲーム（探索アルゴリズム体験教材）— 画面・操作仕様（ラウンド1〜4）

## 画面一覧（正式名称、目的、誰が使う、入口/出口）

### 1) タイトル画面

- 正式名称：タイトル画面
- 目的：ユーザID確認と開始操作
- 利用者：生徒（主）、教員（投影・説明）
- 入口：教材URLへアクセス
- 出口：「はじめる」クリックで未クリアのラウンドへ遷移

### 2) ラウンド開始演出（オーバーレイ）

- 正式名称：ラウンド開始演出
- 目的：ラウンド名・探索方式・タスク提示
- 利用者：生徒（主）、教員（投影・説明）
- 入口：各ラウンド開始時
- 出口：自動フェードアウトで探索ゲーム画面へ

### 3) 探索ゲーム画面（ラウンド1〜4）

- 正式名称：探索ゲーム画面（ラウンド1〜4）
- 目的：名簿から目標人物を探し、探索回数と時間を体験する
- 利用者：生徒（主）、教員（投影・説明）
- 入口：タイトル画面または次ラウンドボタン
- 出口：クリア前から同一画面内でランキングを表示（遷移しない）

### 4) 結果画面

- 正式名称：結果画面
- 目的：ラウンド1〜4のランキングを一覧表示する
- 利用者：生徒（主）、教員（投影・説明）
- 入口：ラウンド4のリンク
- 出口：なし

---

## 画面遷移（文章＋簡易図）

[教材URL]

  ↓

[タイトル画面]

  └─（はじめる）→ クリア記録確認 → 未クリアのラウンドへ

           ↓

      [ラウンド開始演出]

           ↓

      [探索ゲーム画面（ラウンドN）]

        ├─（行クリックを繰り返す／ランキング表示は常時更新）

        ├─（正解行クリック）→ クリア → 全データ開示

        └─（ランキングが10件以上）→ 次ラウンドのみ活性化 → ラウンド開始演出へ

      （ラウンド4のみ）右下リンク → [結果画面]

[結果画面]

  ├─（ラウンド1〜4ランキングを1秒更新）


※ブラウザの戻るボタンは無効化し、画面状態は変化しない

---

## 各画面の項目定義（入力、表示、エラー、バリデーション）

## タイトル画面

### 表示

- タイトル、ユーザID、注意文を表示
- 「はじめる」ボタンを表示

### 操作

- 「はじめる」クリックでクリア記録を確認し、未クリアのラウンドへ遷移

## ラウンド開始演出

### 表示

- 左上から「ラウンド〇」が降ってくる演出を表示（大きめ）
- 中央に探索方式（例：単純前方探索）を跳ねるように大きめ表示
- 次の行にタスク文字列（例：こばやし　ゆうじ　を探せ！）を跳ねるように大きめ表示
- タスク文中の目標名（例：こばやし　ゆうじ）を太字・少し大きめ・レインボーにキラキラ表示
- 中央文字列の右手に画像を出現させる
- 数秒後にフェードアウトして探索ゲーム画面へ遷移

### 操作

- 演出中は名簿クリックを受け付けない


## 探索ゲーム画面（ラウンド1〜4）

### 上部ヘッダ（タイトル領域）

- 表示：
  - タイトル：「探索ゲーム」
  - ラウンド表示：現在ラウンド（ラウンド1〜FINAL）をタイトル右横に大きめに表示し、ゴール文言（〜を探せ！）も併記する
  - ラウンド一覧（1〜FINAL）はナンバーのみ表示し、現在ラウンドを強調色で表示
  - 次ラウンドのみ、ランキングが10件以上の時点で活性化（クリア不要）
  - 過去ラウンド／次ラウンド以降は非活性（色は状態に応じた指定色）
  - ラウンドボタンの色（開始前／クリア前／クリア後）：
    - 現在ラウンド：緑／緑／紺
    - 以前ラウンド：濃い緑／濃い緑／紺
    - 次ラウンド：薄い灰色／薄い灰色／明るめ青（枠線は明るい赤で太め、ふわふわ浮遊し拡大時にさらに明るくなる）
    - 次の次以降：薄い灰色／薄い灰色／暗い灰色
  - ユーザID表示：画面右上に現在のユーザIDを表示（URLの #id= から取得、未設定時は注意文言）

### 左ペイン（名簿テーブル領域）

- 表示：
  - 表形式（列：連番 / 年 / 組 / 番 / 氏名 / インデクス（ラウンド2のみ、かな列の左・見出し空白・1文字幅）/ ふりがな）
  - 名簿表はスクロール領域で表示し、ヘッダ行はスクロール中も固定表示する
  - 初期状態：枠と連番のみ（ラウンド2はインデクス列を表示）
  - 表の左下に memory.png を常時表示（現行の3倍サイズ、#列と重ならないよう少し右寄せ）
  - 横罫線はふりがな列も含めて揃える
  - 行の高さはCPUアイコン表示で変化しないよう固定
  - ラウンド2のインデクス列は、かな行の最初のみ「あ/か/さ/た/な/は/ま/や/ら/わ」を表示し、それ以外は空白にする
  - ラウンド2のインデクス列の文字色は赤で強調する
  - ラウンド2以降はふりがなヘッダ右に赤い▲を表示し、クリア後も赤色のままにする
- 操作：
  - 行クリックで、その行のデータが表示される（当該行のみ開示）
  - 未クリック行のクリックで探索回数+1（クリック済み行は回数が増えない）
  - 行クリック時、ふりがなの左に cpu.png を表示し、0.3秒ごとに1文字ずつ赤色でマッチング演出（処理中は他行クリック無効、終了後に年/組/番/氏名を表示）
  - マッチング演出完了後、cpu位置に「matched/unmatched」アイコンを小さく表示（matched=緑、unmatched=赤）
  - ふりがなは最大10文字程度が表示できる幅を確保する
  - 年・組・番の列幅を少し狭め、ふりがな列を広めに確保する
- クリア後：
  - 全行のデータを開示
  - 未クリック行（＝当該行を一度もクリックしていない行）の文字色を青にする
  - 以後の行クリックは無効（カーソル・ホバー等も無効化）

### ラウンド別表示差分
- ラウンド1：同一クラス＋正解データをランダム表示
- ラウンド2：同一学年＋正解データをかな順＋インデクス列（かな行の先頭のみラベル表示）
- ラウンド3：同一学年＋正解データをかな順
- ラウンド4：全体名簿をかな順表示（正解はアクセス中ユーザ）

### 右ペイン（状況・ランキング領域）

- 上部：探索回数とタイムを横並びで大表示
  - 表示：探索回数（整数）
  - 表示：タイム（mm:ss.mmm、ミリ秒は3桁固定で0.100のように表示、固定幅フォントで数字幅の揺れを抑える）
- 下部：ランキング
  - ユーザID確定後にカードを表示（クリア不要）：
    - 同一クラスのランキング（全員）
    - 並び順はタイム昇順（同タイムの場合は回数昇順）
    - 表示名は「番＋氏名（フルネーム）」
    - 表形式（順位／番／氏名／タイム／回数）で縦位置を揃える（タイム列に▲を付与）
    - 各セルは中央寄せ
    - タイム列の右側に少し余白を設ける
    - 全員表示のためスクロールで確認できる
    - 一覧表の縦幅は固定し、画面内に収まるよう右ペイン内の残り高さに合わせる
    - ヘッダはスクロール時も表示し続け、スクロールバーはヘッダ横まで表示する
    - クリア後のランキングヘッダ背景は名簿表のヘッダと同色にする
    - 更新中／表示完了などのステータス文言は表示しない
    - ラウンド4のクリア後は右下に「結果画面にいく」リンクを表示する（ラウンドボタン相当のサイズで、ふわっと拡大縮小）

### 表示ルール（色・演出）

- 開始前：白ベース
- 探索中（最初のクリック〜クリア前）：黄緑ベース
- クリア後：紺色ベース（左ペイン/右ペイン/表ヘッダ/メイン領域/ページ背景を同一色の紺に切替、メイン領域の枠線はなし）
- クリア時に紙吹雪（大量）と「クリアおめでとう！」を大きく表示し、派手な色でキラキラさせた演出を画面全体に表示

### 入力（ユーザID）

- 方式：アクセスURLの末尾に「#id=ユーザID」を付けて指定（入力欄なし）
- バリデーション：
  - 空欄不可（未設定の場合は開始不可／ヘッダに注意表示）
  - student.csv に存在するユーザIDのみ開始可能（未登録は注意表示）
  - 文字数上限（例：32）
  - 使用文字（英数・ハイフン・アンダースコア等）を推奨（未確定）

### エラー表示方針

- 通信エラー：
  - 送信失敗：画面表示は更新せず、ゲームの進行は止めない
  - ランキング取得失敗：表示は更新せず、ゲームの進行は止めない
- データエラー：
  - 名簿データが読み込めない場合：画面中央に致命エラー表示（授業継続不可）
  - user_id が名簿に存在しない場合：ヘッダに注意表示し開始不可

## 結果画面

### 表示

- ラウンド1〜4のランキングをカードごとに表示する
- 各ランキングは1秒おきに自動更新する
- 画面上部にユーザIDを表示する
- カード背景はクリア後と同じ紺色ベースにする
- ラウンド1/2を1行目、ラウンド3/FINALを2行目に2列で配置し、1画面内に収める
- ランキング表は各カード内でスクロールできるようにする
- ランキング表のタイム列ヘッダに▲を表示する

### 操作

（操作ボタンなし）

---

## 操作手順（生徒用／教員用）

### 生徒用（ラウンド1〜4）

1. URL末尾に「#id=ユーザID」を付けて画面を開く（未設定だと開始できない）

2. タイトル画面で「はじめる」をクリックし、未クリアのラウンドから開始する

3. ラウンド開始演出を確認後、名簿の行をクリックして探索する（クリック毎に回数が増える）

4. 目標人物の行をクリックしてクリア

5. クリア後、全データが表示され、未クリック行が青字で示される

6. 右側に同一クラスのランキングが全員表示され続ける（クリア前から、2秒おきに更新が続く）
7. ランキングが10件以上になると次ラウンドのボタンのみ活性化する（クリア不要、前後ラウンドは非活性）
8. ラウンド4クリア後、右下リンクから結果画面へ進む（結果画面は1秒おきに更新）

### 教員用（ラウンド運用）

- 授業開始前に教材URLを提示
- クリア前からランキングを投影し、タイムの差に着目させる
- 授業後にログファイルを回収し、集計に利用
---

## 未確定事項リスト（初版）

- ユーザID指定リンクの配布方法（例：クラスごとに #id= を付けたURLを共有）
