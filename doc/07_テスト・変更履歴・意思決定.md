# 探索ゲーム（探索アルゴリズム体験教材）— テスト・変更履歴・意思決定（ラウンド1〜4）

## テスト観点（画面、機能、ログ、異常系、環境差）
### 画面
- レイアウト崩れがない（1920x1080 / 1366x768想定）
- 文字が十分大きく、主要情報が読みやすい
- 表がスクロールできる（行数が多い場合）
- 名簿表が固定高さでスクロールし、ヘッダが常に表示される
- 名簿表の左下に memory.png が常時表示され、3倍サイズで#列と重ならない位置にある
- 名簿表の横罫線がふりがな列も含めて揃っている
- cpu.png表示中でも行の高さが変わらない（固定の行高）
- 年・組・番の列幅が狭まり、ふりがな列が広く確保されている
- タイトル左上の「探索ゲーム」の横にラウンド表示が大きめに表示される
- ラウンド表示にゴール文言（〜を探せ！）が併記される
- ラウンドナビは番号のみで表示される
- 現在ラウンドは強調表示される
- 次ラウンドのみランキングが10件以上の時点で活性化する（10件未満は非活性）
- ラウンドボタンの色は開始前／クリア前／クリア後で指定色に切り替わり、次ラウンドは明るめ青＋赤枠太め＋ふわふわ浮遊（拡大時にさらに明るくなる）で強調される
- 探索回数の右横にタイム表示が配置される
- タイムはミリ秒3桁固定で表示される（例：0.100）
- タイム表示が固定幅フォントで数字の横幅が揺れない
- 計測状態の欄は表示されない
- ベストスコアはクリア前から表示される（リザルトは表示しない）
- 開始前／探索中／クリア後で画面のベース色が切り替わる
- クリア後は名簿/状況パネルの背景が紺色ベースで文字が読みやすい
- クリア後は表ヘッダも紺色ベースで文字が読みやすい
- クリア後はメイン領域（左右ペインの外側）の背景も紺色ベースになる
- クリア後はページ背景も紺色ベースになり、外周の白さが残らない
- クリア後はページ背景とメイン領域の色差がなく、メイン領域の枠線が表示されない
- クリア時に紙吹雪と「クリアおめでとう！」演出が表示される
- クリア時の「クリアおめでとう！」が大きく、派手な色でキラキラ表示される
- 紙吹雪の量が多く派手に見える
- 画面上部に操作説明の常時表示がなく、ラウンド表示にゴール文言が含まれる
- ヘッダ右上に #id= で指定したユーザIDが表示される（未設定時は注意文）
- ランキングが表形式で縦位置が揃っている（順位／番／氏名／タイム／回数）
- 回数とタイムが別列で表示される
- ランキング表の各セルが中央寄せで、タイム列の右側に少し余白がある
- ランキングはスクロールで全員を確認できる
- クリア前でもランキング（ベストスコア）が表示される
- ランキング一覧の縦幅が画面内に収まり、最下位までスクロールで見える
- ベストスコア一覧が固定高さのスクロール領域で表示される
- ランキングヘッダが固定表示され、スクロールバーがヘッダ横まで揃う
- クリア後のベストスコアヘッダ背景が名簿表ヘッダと同色になる
- ランキングの更新中／完了ステータス文言が表示されない

- タイトル画面が最初に表示される
- タイトル画面に「はじめる」ボタンが表示される
- ラウンド開始演出で「ラウンド名」が左上から降下する
- ラウンド開始演出で探索方式・タスク文字列が中央に跳ねて大きめ表示される
- ラウンド開始演出のタスク文中の目標名が太字・大きめ・レインボーにキラキラ表示される
- ラウンド開始演出で中央文字列の右手に画像が表示され、フェードアウトする
- ラウンド2ではインデクス列が表示される
- ラウンド2のインデクス列はかな列の左にあり、見出しは空白・1文字幅で、かな行の先頭だけラベルが表示される
- ラウンド2のインデクス列の文字色が赤で表示される
- ラウンド4のリザルト右下に「結果画面にいく」リンクが表示される
- ラウンド4の「結果画面にいく」リンクがラウンドボタン相当サイズでふわっと拡大縮小する
- 結果画面でラウンド1〜4のランキングが全て表示される
- 結果画面のカード背景がクリア後と同じ紺色ベースになる
- 結果画面に「ゲーム画面に戻る」ボタンが表示されない
- 結果画面が2列2行のレイアウトで、カード内ランキングがスクロールできる
- ラウンド2以降はふりがなヘッダ右に▲が表示され、クリア後も赤色のままになる
- ランキング表のタイム列ヘッダに▲が表示される
- 結果画面のランキングが1秒おきに更新される
- ブラウザの戻るボタンで画面状態が変化しない
### 機能
- 初期状態で「枠と連番のみ」になっている
- 行クリックで当該行だけが開示される
- 未クリック行のクリックで探索回数が増える
- クリック済み行の再クリックでは探索回数が増えない
- 行クリック時にCPUマッチング演出が走り、演出中は他行クリックが無効になる
- マッチング演出完了後に年／組／番／氏名が表示される
- マッチング演出完了後に matched/unmatched のアイコンが表示される
- ふりがなが10文字程度まで右端が切れずに表示される
- URLの #id= が未設定の場合はクリック受付前に警告が出て計測が始まらない
- student.csv に存在しない user_id の場合は開始不可で警告が出る
- 最初のクリックでタイマーが開始する
- 正解行クリックでクリアし、タイマーが停止する
- クリア後に全行開示され、未クリック行が青字になる
- クリア後にクリックが無効になる
- ラウンド1は同一クラス抽出＋正解データ追加後にランダムシャッフルされる
- ランキング取得は10件表示後も継続する

- タイトル画面の「はじめる」で未クリアの最小ラウンドから開始する
- クリア記録が全ラウンドにある場合は結果画面へ遷移する
- ラウンド開始演出中は名簿クリックが無効になる
- ラウンド2のインデクス列は初期状態から表示される
### ログ
- クリア時に送信が行われる
- サーバが受信し、ログへ追記できる（TSV形式が崩れない）
- ランキングAPIが全員分を正しく返す（タイム→探索回数の順でソート）
- ログファイルが `search_game_results.tsv` に生成・追記される
- ランキングは user_id ごとの最良記録のみを集計している
- ログ列に client_ts/client_ver/user_agent が含まれない

### 異常系
- user_id未設定（#id=なし）：開始できない／警告が出る
- user_id未登録（student.csvに存在しない）：開始できない／警告が出る
- 通信失敗：
  - ログ送信失敗でもクリア表示はされる
  - ランキング取得失敗でも画面は固まらない
- student.csv 読み込み失敗：名簿エラーの警告が出て開始不可

- クリア記録取得に失敗した場合でもラウンド開始が継続する（未クリア扱い）
### 環境差
- Chrome（校内端末）で動作
- 文字コード（日本語）が崩れない（UTF-8）

---

## 最低限のテストケース
1. 正常：10回以上クリックしてからクリア → 回数とタイムが表示、全行開示、未クリック青字
2. 最短：1回目のクリックが正解 → 回数1、タイムが極小でも表示崩れなし
3. 二重クリック：同じ行を連続クリック → 回数は増えず、表示は維持
4. 通信失敗（擬似）：サーバURLを存在しないものに変更 → クリアは成立、ランキングは更新されないが画面は固まらない
5. ランキング未満：ログが少なく10件未満 → 2秒おきに再取得し続ける
6. URL指定ID：末尾に #id=test123 を付けてアクセス → ヘッダにIDが表示され、クリックで計測・送信が進む（user_id=test123で送信されることを確認）
7. ID未設定：ハッシュなしでアクセス → ヘッダに注意が出て、行クリックしても回数/タイマーが進まない
8. 画面確認：ラウンド表示にゴール文言が含まれ、探索回数の右横にタイムが表示される
9. 状態色：開始前は白ベース、1回目クリック後〜クリア前は黄緑ベース、クリア後は紺色ベースになる
10. クリア演出：クリア時に紙吹雪と「クリアおめでとう！」が表示される（ベストスコアはクリア前から表示、リザルト欄は表示されない）
11. クリア後の可読性：名簿/状況パネルの背景が紺色で、文字が読みやすい
12. 表ヘッダの可読性：クリア後に表ヘッダ背景が紺色になり、文字が読みやすい
13. メイン領域：クリア後に左右ペイン外側の背景が紺色になっている
14. ページ背景：クリア後にページ外周の背景が紺色になっている
15. 境界確認：クリア後にページ背景とメイン領域の境界が目立たず、枠線がない
16. クリア演出：大きな「クリアおめでとう！」がキラキラ表示され、紙吹雪が大量に出る
17. ID未登録：student.csv に存在しない #id= でアクセス → ヘッダ注意が出て開始不可
18. student.csv 失敗：ファイル名を変えて読み込み失敗させる → 名簿エラー警告が出て開始不可
19. ラウンド1名簿：同一クラス抽出後に「小林 裕司」が追加され、ランダム順で表示される
20. ログ保存：クリア後に `search_game_results.tsv` が作成され、ヘッダ＋1行が追記される
21. ベスト判定：同一 user_id の記録を複数送信 → ランキングはタイム/探索回数が最良の記録のみ反映
22. ランキングURL：`/index.html` からアクセス時、取得先が `/get_ranking.pl` になり404にならない
23. 表示名：ランキングに「番＋氏名（フルネーム）」が表示される
24. 文字化け確認：ランキング表示の氏名がUTF-8で正しく表示される（例：日本語）
25. 表形式：ランキングの順位／番／氏名／タイム／回数が列で揃っている
26. スクロール：ランキングが全員分スクロールで確認できる
27. 更新継続：10件表示後もランキング取得が継続している
28. ラウンド活性化：ランキングが10件以上の時点で次ラウンドのみ活性化する（10件未満は非活性、クリア不要）
29. ナビ状態：現在ラウンドが強調表示され、前後ラウンドは非活性
30. 表示タイミング：クリア前でもランキング（ベストスコア）が表示される
31. 全員表示：10件超の記録がある場合でも全員分が表示される
32. 表示位置：ランキング表のセルが中央寄せで、タイム列の右に余白がある
33. ログ列：`search_game_results.tsv` のヘッダに client_ts/client_ver/user_agent が含まれない
34. 一覧高さ：ランキング表の縦幅が画面内に収まり、最下位までスクロールで確認できる
35. ナビ色：開始前／クリア前／クリア後で各ラウンドボタンが指定色になる
36. 次ラウンド強調：クリア後の次ラウンドが明るめ青＋赤枠太め＋ふわふわ浮遊（拡大時にさらに明るくなる）で表示される
37. メモリアイコン：名簿表の左下に memory.png が常時表示され、3倍サイズで#列と重ならない位置にある
38. マッチング演出：行クリックで cpu.png と文字列の赤→黒のアニメーションが0.3秒刻みで進む
39. クリック抑止：マッチング演出中は他行クリックが無効になる
40. 表示タイミング：マッチング演出完了後に年／組／番／氏名が表示され、正解行ならその後にクリア演出が出る
41. ふりがな幅：ふりがなが10文字程度まで右端が切れずに表示される
42. マッチング結果：演出完了後に unmatched（赤）／matched（緑）が表示される
43. タイム表記：0.1秒でも 00:00.100 のようにミリ秒3桁で表示される
44. ランキングヘッダ：スクロールしてもヘッダが固定で、スクロールバーがヘッダ横まで揃う
45. 横罫線：ふりがな列を含め横罫線が揃っている
46. 行高さ：cpu.png表示中でも行高さが変わらず表が揺れない
47. タイム表示：右ペインのタイムが固定幅フォントで表示され、数字の横幅が揃う
48. 列幅調整：年・組・番の列幅が狭まり、ふりがな列が広い
49. タイトル画面：初期表示で「はじめる」が表示され、クリックでラウンド開始演出へ進む
50. クリア記録判定：ラウンド1の記録がある場合はラウンド2から開始する
51. 全クリア判定：ラウンド1〜4に記録がある場合は結果画面へ遷移する
52. ラウンド演出：各ラウンドで指定文言が表示され、目標名が大きめ太字のレインボー演出になり、数秒後に名簿画面へ遷移する
53. ラウンド2インデクス：初期状態からインデクス列が表示される
54. 結果画面：ラウンド1〜4のランキングが表示され、1秒更新が継続する
55. 結果リンク：ラウンド4クリア後の右下リンクで結果画面に遷移する
56. 戻る抑止：ブラウザの戻るボタンを押しても画面状態が変化しない
57. 名簿ヘッダ固定：名簿表がスクロールしてもヘッダが固定で表示される
58. ベストスコア高さ：ベストスコア一覧が固定高さでスクロールできる
59. クリア後ヘッダ色：ベストスコアのヘッダ背景が名簿表ヘッダと同色になる
60. インデクス位置：ラウンド2のインデクス列がかな列の左にあり、見出しが空白で1文字幅になっている
61. インデクス内容：かな行の先頭のみ「あ/か/さ/た/な/は/ま/や/ら/わ」が表示され、それ以外は空白になる
62. ラウンド表示：タイトル右横のラウンド表示に「〜を探せ！」が含まれる
63. ランキング順：タイムが小さい順に並び、同タイムの場合は回数が小さい順になる
64. 結果画面背景：結果画面のカード背景がクリア後と同じ紺色ベースになる
65. 結果リンク強調：ラウンド4の「結果画面にいく」リンクが大きく脈動して表示される
66. 結果画面操作：結果画面に「ゲーム画面に戻る」ボタンが表示されない
67. 結果画面配置：ラウンド1/2が1行目、ラウンド3/FINALが2行目に並び、1画面内に収まる
68. 結果画面スクロール：各カード内のランキング表がスクロールできる
69. かなヘッダ表示：ラウンド2以降のふりがなヘッダに▲が表示され、クリア後も赤色のままになる
70. インデクス色：ラウンド2のインデクス列の文字が赤で表示される
71. ベストスコア順序：ベストスコアのタイム列ヘッダに▲が表示される
72. 結果画面順序：結果画面のタイム列ヘッダに▲が表示される

---

## 変更履歴（初版作成を含む）
- 2026-01-12 23:32：開始演出の文字強調とレインボー演出、次ラウンド強調の明度/浮遊アニメーション、▲色固定、メモリアイコン位置を調整
- 2026-01-12 23:21：かな/タイムのヘッダ記号を▲に修正
- 2026-01-12 22:22：かな/タイムの▲表示とインデクス赤字を追加し、結果画面の2x2配色を調整
- 2026-01-12 21:56：結果画面を2x2レイアウトに固定し、カード配色とスクロールの可読性を調整
- 2026-01-12 21:40：ランキングの並び順をタイム優先に変更し、回数/タイム列の順序入替、結果画面の配色・リンク強調・戻るボタン撤去、ラウンド表示へのゴール文言追加を調整
- 2026-01-12 19:04：次ラウンド活性化条件を10件以上に調整し、ラウンド2のインデクス列の位置と表示ルールを更新
- 2026-01-12 18:45：ベストスコアのヘッダ配色統一と、次ラウンド活性化条件を10件超に変更
- 2026-01-12 18:36：名簿表の固定スクロールとヘッダ固定、ベストスコアの固定高さスクロールを調整
- 2026-01-12 16:35：ラウンド1〜4対応に伴い、タイトル画面／開始演出／結果画面／根ディレクトリ配置／戻る無効化を追加
- 2026-01-11 00:55：年・組・番の列幅を狭め、ふりがな列幅を拡張
- 2026-01-11 00:49：ふりがな列の横罫線ズレ解消、cpu表示で行高さ固定、タイムの固定幅フォント化を反映
- 2026-01-11 00:12：ふりがな列幅の調整、matched/unmatched表示、タイム3桁固定、ランキングヘッダとスクロールの揃えを反映
- 2026-01-10 23:55：memory/cpuのサイズ調整、マッチング演出の間隔短縮、ふりがな表示幅の確保を反映
- 2026-01-10 23:38：メモリアイコン常時表示とCPUマッチング演出を追加し、演出完了後に行表示・クリア演出を行うよう調整
- 2026-01-10 23:12：次ラウンド（クリア後）の赤枠を太くし、拡大縮小のアニメーションで目立たせた
- 2026-01-10 22:52：ラウンドナビの色を状態別（開始前／クリア前／クリア後）に固定し、前後/次/次の次の表示差を明確化
- 2026-01-10 22:24：ランキングをクリア前から表示し、ラウンドナビの強調/非活性/次ラウンドのみ活性化のルールを反映
- 2026-01-10 22:05：ランキング一覧の縦幅を画面内に収め、最下位までスクロールできるよう調整
- 2026-01-10 21:47：ログから client_ts/client_ver/user_agent を除外し、ランキング表の中央寄せとタイム列余白を調整
- 2026-01-10 21:16：ランキングを全員表示に変更し、回数/タイムの分列表示と列幅調整を反映
- 2026-01-10 19:10：ランキング表示を表形式に変更し、スクロール対応・継続更新・ラウンド活性化条件・再クリック時の回数抑止を反映
- 2026-01-10 18:54：ランキング表示名を「番＋氏名（フルネーム）」に変更
- 2026-01-10 18:49：ランキング/ログ応答のUTF-8二重エンコードを避けるため、CGI出力をRAWに統一
- 2026-01-10 18:41：ランキング取得URLの基準を現在ページに合わせ、/proto 配下でも 404 にならないよう修正
- 2026-01-10 17:20：プロトタイプ用の `proto/log_result.pl` と `proto/get_ranking.pl` を追加し、同一フォルダのTSVへ保存＋ベストスコアランキング取得に対応
- 2026-01-10 16:25：student.csv を名簿の単一ソースに変更し、roster.js 経由でラウンド別抽出・ユーザID照合を行うよう更新
- 2026-01-10 16:04：リザルト欄を削除し、ベストスコアのみ表示する構成に変更
- 2026-01-10 15:59：クリア演出の文字を大きく派手にし、紙吹雪の量を増やした
- 2026-01-10 15:56：クリア後のページ背景とメイン領域背景を同色化し、メイン領域の枠線を削除
- 2026-01-10 15:53：クリア後のページ背景と表スクロールバーを暗色化し、外周の白さを抑制
- 2026-01-10 15:49：クリア後のメイン領域背景を紺色に強制し、ペイン外側の明るさを抑制
- 2026-01-10 15:46：クリア後の左/右ペイン・表ヘッダの背景色を強制上書きして紺色ベースを確実化
- 2026-01-10 15:08：クリア後の名簿/状況パネルを濃い紺色ベースに再調整し可読性を強化
- 2026-01-10 15:04：クリア後の名簿/状況パネル背景を紺色ベースに寄せ、可読性を改善
- 2026-01-10 14:55：計測状態欄の削除、リザルト/ベストスコアのクリア後表示、状態別配色と紙吹雪演出を追加
- 2026-01-10 13:53：タスク文言・操作説明を非表示化し、ラウンド表示をタイトル横へ移動、タイム表示を探索回数の右に配置
- 2026-01-09 17:20：ヘッダにタスク文言を集約、ラウンドナビを番号のみ化、ユーザID指定をURLハッシュ＋ヘッダ表示に変更（右下入力欄を撤去）
- 2026-01-09：初版（プロトタイプ：ラウンド1）作成

---

## 意思決定メモ（なぜそうしたか／代替案）
- クリア記録が全ラウンドにある場合は結果画面へ遷移する：再プレイより結果閲覧を優先し、戻る導線を別途用意するため
- ラウンド2のインデクス列は初期状態から表示する：改良型前方探索の導線として必要な情報を先に示すため
- ラウンド開始演出の画像は memory.png を使用する：既存素材を流用し、外部依存を増やさないため
- ラウンド開始演出のタスク文中の目標名をレインボーで強調し文字サイズを上げる：視線誘導と盛り上げを強めるため  
  - 代替：通常色のまま（目標の注目が弱くなるため不採用）
- クリア記録の取得失敗は未クリア扱いとする：誤ってスキップするよりも再開を優先するため
- 名簿は student.csv を単一ソースにし、roster.js で読み込む方式に統一：ラウンド別JSファイルの二重管理を避けるため  
  - 代替：CSVをビルド時にJSへ変換して配布する案もあるが、運用時の更新手順が複雑になるため採用せず
- 正解判定は「追加した正解データ行」を isTarget で識別：ふりがな一致だけだと同名の誤判定が起き得るため  
  - 代替：ふりがな一致のみで判定する案（簡易だが衝突リスクがあるため不採用）
- 名簿に存在しない user_id は開始不可：誤入力の早期検出とクラス抽出の整合性を優先するため  
  - 代替：未登録IDでも仮想クラスで開始する案（授業の名簿整合が崩れるため不採用）
- ユーザID指定をURLハッシュ（#id=）に統一しヘッダ表示：授業前に配布するURLだけで設定でき、右ペインをランキング用に空けるため  
  - 代替：画面内入力欄やクエリパラメータを残す案もあったが、入力欄がスペースを占有し誤入力も起きやすいため採用せず
- ラウンド表示にゴール文言を併記し、操作説明は常時表示しない：目標を明確化しつつ画面上部の情報量を抑えるため  
  - 代替：ゴール文言をラウンド開始演出のみで示す案（探索中に目標が見えにくいため不採用）
- タイム表示を探索回数の右横に配置：回数とタイムを並べて比較しやすくするため  
  - 代替：従来どおり計測カード内に置く案（視線移動が増えるため不採用）
- 計測状態欄を削除し、進行状態はタイム表示と画面配色で伝える：右ペインの情報量を減らし、探索に集中させるため  
  - 代替：計測状態カードを残す案（情報が分散し、主情報の視認性が下がるため不採用）
- リザルト/ベストスコアをクリア後に表示：探索中に結果が見えないようにし、ゲーム体験を保つため  
  - 代替：常時表示する案（探索中の注意が散るため不採用）
- 開始前/探索中/クリア後で配色を切り替え、クリア時に紙吹雪演出を追加：進行状態と達成感を直感的に示すため  
  - 代替：配色を固定し演出を追加しない案（状態変化が伝わりにくいため不採用）
- クリア後の名簿/状況パネル背景を紺色寄りに強める：クリア後の文字の可読性を確保するため  
  - 代替：背景の透明度を低く保つ案（背景と文字が重なり見づらいため不採用）
- クリア後パネルの紺色をさらに濃くし、文字色も明るめに調整：名簿と状況の視認性を最優先するため  
  - 代替：背景色のみを少し濃くする案（改善が弱いため不採用）
- クリア後の左/右ペイン・表ヘッダ背景を明示指定で上書き：CSS変数の解決差による見え方の揺れを抑えるため  
  - 代替：変数のみで切り替える案（環境差で反映が弱い可能性があるため不採用）
- クリア後のメイン領域背景を追加で紺色に設定：ペイン外側の明るさが残る問題を抑えるため  
  - 代替：ボディ背景の暗さだけで対応する案（周辺が明るく見えるため不採用）
- クリア後のページ背景と表スクロールバーを暗色化：外周とスクロールバーの明るさが悪目立ちするのを抑えるため  
  - 代替：ペイン内の配色調整だけで対応する案（外周とスクロールバーの明るさが残るため不採用）
- クリア後のページ背景とメイン領域背景を同色化し枠線を削除：境界が目立つ問題を抑えるため  
  - 代替：枠線を残して外周だけ暗くする案（境界が残るため不採用）
- クリア演出の文字を大きく派手にし、紙吹雪量を増加：達成感と視認性を強く出すため  
  - 代替：既存の文字サイズと紙吹雪量を維持する案（演出が弱く見えるため不採用）
- リザルト欄を削除し、ベストスコアに集約：表示要素を減らし、ランキングを主役にするため  
  - 代替：結果とランキングを並べて表示する案（情報量が多く視線が散るため不採用）
- クリア時のみ送信：授業当日の安定性と個人情報最小化を優先
  - 代替：各クリック送信（分析は強いが、負荷・個人情報・不具合要因が増える）
- 同一オリジン前提：学校ネットワークでCORSが詰まりやすいため
- TSV保存：Excel等で即集計でき、実装が単純
- プロトタイプのログ保存はCGIと同一フォルダにし、`FindBin` で動的にパス解決：配置変更時のハードコードを避けるため
  - 代替：`config.pl` で固定パスを持つ案（運用手間が増えるため今回は不採用）
- ランキングは user_id ごとの最良記録を採用：ベストスコア表示の意図に合わせ、複数回クリアの上書きを自然にするため
  - 代替：全記録をそのまま並べる案（同一ユーザが複数表示されるため不採用）
- ランキングの順位はタイム優先（同タイムは回数）：速さの差を主軸に比較するため  
  - 代替：回数優先（探索回数の差を主に見せたい場合）
- ランキング取得URLは `window.location.href` を基準に解決：プロトタイプの配置パスに追随させるため
  - 代替：`window.location.origin` 基準（ルート固定で /proto 配下だと 404 になるため不採用）
- JSON出力は `binmode(:raw)` で返す：UTF-8の二重変換による文字化けを避けるため
  - 代替：`binmode(:encoding(UTF-8))` のまま `encode_json` を出力（UTF-8が二重化されるため不採用）
- 表示名は「番＋氏名（フルネーム）」にする：クラス内での識別性を高めるため
  - 代替：「番＋苗字」の簡略表示（識別性が不足するため今回は不採用）
- ランキング表示は表形式で列揃えし、ステータス文言は出さない：見た目の整理と不要情報の削減を優先するため
  - 代替：従来の箇条書き＋更新中表示（整列しにくく視線が散るため不採用）
- ランキング更新は10件以降も継続する：授業中の変動を継続的に見せるため
  - 代替：10件到達で停止（更新が止まると動きが見えないため不採用）
- ランキング（ベストスコア）はクリア前から表示する：進行中でもクラス全体の状況を確認できるようにするため  
  - 代替：クリア後のみ表示（進行中の比較ができないため不採用）
- 次ラウンドのみ活性化し、前後ラウンドは非活性のままにする：進行中のラウンドを迷わず示すため  
  - 代替：全ラウンドを活性化（誤操作や混乱が起きやすいため不採用）
- 次ラウンド活性化の条件は「ランキングが10件以上の時点」（クリア不要）：10人以上で活性化する運用要望に合わせるため  
  - 代替：10件到達より前に活性化（未達成で遷移してしまうため不採用）
- ラウンド2のインデクス列を「かな列の左・見出し空白・行頭のみラベル表示」に統一：索引らしさを保ちつつ表幅を最小化するため  
  - 代替：数値インデクスを付与する案（行の密度が上がり、視認性が下がるため不採用）
- ラウンド4の「結果画面にいく」をラウンドボタン相当サイズで脈動表示にする：次の導線を強く示すため  
  - 代替：小さなリンクのまま表示（見落とされやすいため不採用）
- ラウンドボタンの色を開始前／クリア前／クリア後で固定し、現在／以前／次／次の次を色で区別する（活性化条件とは独立）：状態判別を直感化するため  
  - 代替：従来のアクセント色グラデーションで強調する案（色差が分かりにくいため不採用）
- 次ラウンド（クリア後）の枠線を太めにし、明るめ青＋ふわふわ浮遊（拡大時に明るく）で強調：次に押すボタンであることを明確に示すため  
  - 代替：色のみで強調する案（視線誘導が弱いため不採用）
- クリック済み行は再クリックしても回数を増やさない：探索回数を実質的な探索回数に寄せるため
  - 代替：クリック毎に増加（連打で回数が水増しされるため不採用）
- ランキングは全員表示にする：クラス全体の状況を一覧で把握できるようにするため
  - 代替：上位10のみ表示（下位の動きが見えないため不採用）
- ランキング一覧の縦幅は右ペイン内の残り高さに合わせ、一覧内スクロールで最下位まで見えるようにする：画面外へのはみ出しを防ぐため
  - 代替：固定の最大高さを維持する案（画面サイズ次第で下端が見えないため不採用）
- 名簿表/ベストスコアのスクロール領域を固定するため、ゲーム画面の高さ基準をビューポートに合わせる：画面切替で高さが崩れるのを避け、プロトタイプ相当の挙動を保つため
  - 代替：スクリーン要素の高さを100%固定にする案（画面構成差での崩れを避けるため不採用）
- 回数とタイムを別列に分け、順位/番の列幅を狭める：比較のしやすさと表の視認性を優先するため
  - 代替：スコアを1列にまとめる表示（列が詰まりやすく見づらいため不採用）
- 回数とタイムの列位置を入れ替え、タイムを先に表示する：タイム順のランキングと視線の流れを一致させるため  
  - 代替：回数を先に表示する案（並び順と表示順が一致しないため不採用）
- ふりがな/タイムのヘッダに▲を付与し、かなソート/タイム順を明示する（▲はクリア後も赤色固定）：並び順の意図を視覚的に伝えるため  
  - 代替：文言での説明のみ（見落としやすいため不採用）
- ラウンド2のインデクス列を赤字にする：索引の存在を目立たせるため  
  - 代替：通常色のまま運用（視認性が弱いため不採用）
- 名簿左下に memory.png を常時表示し（#列と重ならないよう少し右寄せ）、行クリック時は cpu.png と文字列マッチングの逐次アニメーションを挟む：メモリ参照を明示しつつ表の視認性を保つため  
  - 代替：元の位置のまま表示（#列と重なりやすいため不採用）
- memory/cpuのサイズを上げ、マッチング演出を0.3秒刻みにする：視認性とテンポの両立を優先するため  
  - 代替：0.5秒のまま維持する案（テンポが遅く感じるため不採用）
- ふりがなの表示幅を10文字程度まで確保する：右端の欠けを防ぐため  
  - 代替：現状の列幅維持（文字が切れて読みにくいため不採用）
- 年・組・番の列幅を少し削り、ふりがな列に幅を回す：ふりがなが見切れないことを優先するため  
  - 代替：氏名列のさらなる縮小（氏名の可読性が下がるため不採用）
- マッチング結果を matched/unmatched の小さなバッジで表示する：処理結果の理解を補助するため  
  - 代替：バッジなしで行表示のみ（結果が即座に伝わりにくいため不採用）
- タイムはミリ秒3桁固定で表示し、数字の揺れを抑える：視認性の安定化を優先するため  
  - 代替：現行の表示を維持（数字の揺れが気になるため不採用）
- ランキング領域全体にスクロールを持たせ、ヘッダを固定表示する：ヘッダとデータのズレを防ぐため  
  - 代替：データ側のみスクロール（ヘッダとの幅ズレが出るため不採用）
- クリア後のランキングヘッダ背景を名簿表ヘッダと同色に統一：暗色背景で文字が沈むのを防ぎ、統一感を保つため  
  - 代替：ランキングヘッダのみ明るくする案（名簿表との一貫性が下がるため不採用）
- 結果画面のカード背景をクリア後と同じ紺色ベースにする：画面全体の世界観と状態の統一感を保つため  
  - 代替：明るいカード背景のまま運用（結果画面だけ印象が変わるため不採用）
- 結果画面の「ゲーム画面に戻る」ボタンを撤去：結果閲覧専用の画面として扱うため  
  - 代替：戻るボタンを残す案（導線が増え、結果閲覧が中断されやすいため不採用）
- 結果画面を2x2レイアウトに固定し、ランキングはカード内でスクロールさせる：1画面に全ラウンドを収めつつ視認性を保つため  
  - 代替：縦並びのままページスクロールで見る案（全体像が把握しづらいため不採用）
- ログから client_ts/client_ver/user_agent を外す：個人情報最小化とプロトタイプの必要最小構成を優先するため
  - 代替：デバッグ目的で保持する案（収集コストと運用負担が増えるため不採用）
- ランキング表のセルは中央寄せ、タイム列の右に余白を設ける：列の視認性と読みやすさを優先するため
  - 代替：左/右寄せの混在で強調する案（列の視線が揺れるため不採用）
- ふりがな列の横罫線ズレを避けるため、ふりがなセルのレイアウトは内部ラッパーでflexにする：表の罫線の揃いを優先するため
  - 代替：横罫線を行側に移す案（セル表示を崩さず直す方法を優先）
- cpu.png表示で行高さが変わらないよう、行のline-heightを固定：クリック時の表の揺れを抑えるため
  - 代替：cpu.pngを絶対配置で重ねる案（構造変更が大きいため不採用）
- タイム表示を固定幅フォントにする：数字の横幅差によるちらつきを抑えるため
  - 代替：プロポーショナルのままタブラー数字のみで調整（揺れが残るため不採用）

---

## 整合チェック結果（初版）
- 画面仕様（02）と機能仕様（03）の対応：OK（行クリック→回数→タイム→クリア→送信→ランキング）
- ログ設計（04）と実装設計（05）の対応：OK（クリア結果ログをPOSTで送信）
- セキュリティ（06）と実装（05）の矛盾：なし（氏名は送らず、サーバ側で付与）

---

## 未確定事項リスト（初版）
- ラウンド2〜4の拡張時、1画面継続か画面分割か
- 送信失敗の再送仕様（自動・手動）
- ランキングの表示名（個人情報配慮）の最終決定
